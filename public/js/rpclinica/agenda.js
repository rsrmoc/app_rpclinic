(()=>{function a(a,e){var n=Object.keys(a);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(a);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.push.apply(n,o)}return n}function e(e){for(var o=1;o<arguments.length;o++){var i=null!=arguments[o]?arguments[o]:{};o%2?a(Object(i),!0).forEach((function(a){n(e,a,i[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))}))}return e}function n(a,e,n){return e in a?Object.defineProperty(a,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):a[e]=n,a}Alpine.data("app",(function(){return{ooo:null,agendaEspecialidades:[],agendaProcedimentos:[],agendaProfissionais:[],agendaLocais:[],agendaConvenios:[],loadingEspecialidade:!1,loadingDelEspecialidade:null,loadingProcedimento:!1,loadingDelProcedimento:null,loadingProfissional:!1,loadingDelProfissional:null,loadingLocal:!1,loadingDelLocal:null,loadingConvenio:!1,loadingDelConvenio:null,loadingGetHorarios:!1,agendaHorarios:null,inputsGeracao:{cd_agenda:null,cd_escala:null,horarios_bloqueados:[],feriados:[]},loadingGeracao:!1,loadingExclusao:!1,dadosExclusao:[],datasParaExluir:[],loadingExclusaoToggle:!1,param:{agenda:null,escala:null},textIcoSalvar:'<i class="fa fa-check"></i> Salvar',listaEscalas:null,modalEdicao:null,showDivEdicao:!0,codEscalaEdicao:null,msgEdicao:null,agendaEncaixe:!1,listaAgendaExaixe:[],dadosEscala:null,init:function(){"undefined"!=typeof agenda&&(this.agendaEspecialidades=agenda.especialidades,this.agendaEspecialidades.forEach((function(a){var e;a.nm_especialidade=null===(e=especialidades.find((function(e){return e.cd_especialidade==a.cd_especialidade})))||void 0===e?void 0:e.nm_especialidade})),this.agendaProcedimentos=agenda.procedimentos,this.agendaProcedimentos.forEach((function(a){var e;a.nm_proc=null===(e=procedimentos.find((function(e){return e.cd_proc==a.cd_proc})))||void 0===e?void 0:e.nm_proc})),this.agendaProfissionais=agenda.profissionais,this.agendaProfissionais.forEach((function(a){var e;a.nm_profissional=null===(e=profissionais.find((function(e){return e.cd_profissional==a.cd_profissional})))||void 0===e?void 0:e.nm_profissional})),this.agendaLocais=agenda.locais,this.agendaLocais.forEach((function(a){var e;a.nm_local=null===(e=locais.find((function(e){return e.cd_local==a.cd_local})))||void 0===e?void 0:e.nm_local})),this.agendaConvenios=agenda.convenios,this.agendaConvenios.forEach((function(a){var e;a.nm_convenio=null===(e=convenios.find((function(e){return e.cd_convenio==a.cd_convenio})))||void 0===e?void 0:e.nm_convenio}))),"undefined"!=typeof escala&&(this.listaEscalas=escala)},submitAgenda:function(){$("#formAgenda input[type=submit]").click()},getAgendamentoEncaixe:function(a){var e=this;this.dadosEscala=a,this.agendaEncaixe=!0,console.log(a),axios.get("/rpclinica/json/agendamento-encaixe/".concat(a.cd_escala_agenda)).then((function(a){e.listaAgendaExaixe=a.data.retorno,e.listaAgendaExaixe||(e.agendaEncaixe=!1)})).catch((function(a){toastr.error(a.response.data.message)}))},storeAgendamentoEncaixe:function(a){var e=this,n=$("#enc_horario"+a).val();axios.post("/rpclinica/json/agenda-escala-encaixe/".concat(a,"/").concat(n)).then((function(n){$("#enc_horario"+a).val(null).trigger("change"),e.listaAgendaExaixe=n.data.retorno,e.listaAgendaExaixe||(e.agendaEncaixe=!1),toastr.success(n.data.message)})).catch((function(a){return toastr.error(a.response.data.message)}))},openModalGeracao:function(a,e){this.agendaHorarios=null,this.loadingGetHorarios=!0,this.inputsGeracao.cd_agenda=a,this.inputsGeracao.cd_escala=e,this.inputsGeracao.horarios_bloqueados=[],this.inputsGeracao.feriados=[],this.dadosExclusao=[],this.datasParaExluir=[],this.getHorarios(a,e),$("#cadastro-geracao").modal("toggle")},getHorarios:function(a,e){var n=this;this.param.agenda=a,this.param.escala=e,axios.post("/rpclinica/json/agenda/horarios",this.param).then((function(a){n.agendaHorarios=a.data,n.inputsGeracao.feriados=n.agendaHorarios.feriados.map((function(a){return a.dt_feriado})),n.agendaHorarios.escalas.bloqueios_gerados&&(n.inputsGeracao.horarios_bloqueados=n.agendaHorarios.escalas.bloqueios_gerados.lista_horarios.split(",")),n.agendaHorarios.escalas.feriados_gerados&&(n.inputsGeracao.feriados=n.agendaHorarios.escalas.feriados_gerados.lista_datas.split(","))})).catch((function(a){return toastr.error(a.response.data.message)})).finally((function(){return n.loadingGetHorarios=!1}))},timeCut:function(a){return null==a?void 0:a.substr(0,5)},calcIntervalo:function(a){return"".concat(parseInt(a/60).toString().padStart(2,0),":").concat(parseInt(a%60).toString().padStart(2,0))},limparEscala:function(){this.msgEdicao="",this.showDivEdicao=!0,this.codEscalaEdicao=null,$("#check-particular span").removeClass("checked"),$("#check-particular input").prop("checked",!1),$("#check-convenio span").removeClass("checked"),$("#check-convenio input").prop("checked",!1),$("#check-sus span").removeClass("checked"),$("#check-sus input").prop("checked",!1),$("#check-segunda span").removeClass("checked"),$("#check-segunda input").prop("checked",!1),$("#check-terca span").removeClass("checked"),$("#check-terca input").prop("checked",!1),$("#check-quarta span").removeClass("checked"),$("#check-quarta input").prop("checked",!1),$("#check-quinta span").removeClass("checked"),$("#check-quinta input").prop("checked",!1),$("#check-sexta span").removeClass("checked"),$("#check-sexta input").prop("checked",!1),$("#check-sabado span").removeClass("checked"),$("#check-sabado input").prop("checked",!1),$("#check-domingo span").removeClass("checked"),$("#check-domingo input").prop("checked",!1),$("#check-sessao span").removeClass("checked"),$("#check-sessao input").prop("checked",!1),$("#hora_inicial").val(null),$("#hora_final").val(null),$("#qtde_encaixe").val(null).trigger("change"),$("#qtde_sessao").val(null).trigger("change"),$("#intervalo").val(null).trigger("change")},editarEscala:function(a){this.msgEdicao="<br><code><b>Atenção!!!</b> Você esta editando a escala [ "+a.cd_escala_agenda+" ], Alterando os campos de Hora Inicial, Hora Final ou Intervalo, os agendamentos serão desvinculado da escala atual. </code>",this.showDivEdicao=!1,this.codEscalaEdicao=a.cd_escala_agenda,$("#check-particular span").removeClass("checked"),$("#check-particular input").prop("checked",!1),"1"==a.sn_particular&&($("#check-particular span").addClass("checked"),$("#check-particular input").prop("checked",!0)),$("#check-convenio span").removeClass("checked"),$("#check-convenio input").prop("checked",!1),"1"==a.sn_convenio&&($("#check-convenio span").addClass("checked"),$("#check-convenio input").prop("checked",!0)),$("#check-sus span").removeClass("checked"),$("#check-sus input").prop("checked",!1),"1"==a.sn_sus&&($("#check-sus span").addClass("checked"),$("#check-sus input").prop("checked",!0)),$("#check-segunda span").removeClass("checked"),$("#check-segunda input").prop("checked",!1),"segunda"==a.cd_dia&&($("#check-segunda span").addClass("checked"),$("#check-segunda input").prop("checked",!0)),$("#check-terca span").removeClass("checked"),$("#check-terca input").prop("checked",!1),"terca"==a.cd_dia&&($("#check-terca span").addClass("checked"),$("#check-terca input").prop("checked",!0)),$("#check-quarta span").removeClass("checked"),$("#check-quarta input").prop("checked",!1),"quarta"==a.cd_dia&&($("#check-quarta span").addClass("checked"),$("#check-quarta input").prop("checked",!0)),$("#check-quinta span").removeClass("checked"),$("#check-quinta input").prop("checked",!1),"quinta"==a.cd_dia&&($("#check-quinta span").addClass("checked"),$("#check-quinta input").prop("checked",!0)),$("#check-sexta span").removeClass("checked"),$("#check-sexta input").prop("checked",!1),"sexta"==a.cd_dia&&($("#check-sexta span").addClass("checked"),$("#check-sexta input").prop("checked",!0)),$("#check-sabado span").removeClass("checked"),$("#check-sabado input").prop("checked",!1),"sabado"==a.cd_dia&&($("#check-sabado span").addClass("checked"),$("#check-sabado input").prop("checked",!0)),$("#check-domingo span").removeClass("checked"),$("#check-domingo input").prop("checked",!1),"domingo"==a.cd_dia&&($("#check-domingo span").addClass("checked"),$("#check-domingo input").prop("checked",!0)),$("#check-sessao span").removeClass("checked"),$("#check-sessao input").prop("checked",!1),"1"==a.sn_sessao&&($("#check-sessao span").addClass("checked"),$("#check-sessao input").prop("checked",!0)),$("#data_inicial").val(a.dt_inicial),$("#data_final").val(a.dt_fim),$("#hora_inicial").val(a.hr_inicial),$("#hora_final").val(a.hr_final),$("#qtde_encaixe").val(null).trigger("change"),$("#qtde_encaixe").val(a.qtde_encaixe).trigger("change"),$("#qtde_sessao").val(null).trigger("change"),$("#qtde_sessao").val(a.qtde_sessao).trigger("change"),$("#tipo_agenda").val(null).trigger("change"),$("#tipo_agenda").val(a.tp_agenda).trigger("change"),$("#intervalo").val(null).trigger("change"),$("#intervalo").val(a.intervalo).trigger("change"),$("#cd_escala").val(a.cd_escala_agenda)},saveEscala:function(){var a=this;Swal.fire({title:"Confirmação",text:"Tem certeza que deseja confirma essa Alteração?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#22BAA0",cancelButtonColor:"#d33",cancelButtonText:"Não",confirmButtonText:"Sim"}).then((function(e){e.isConfirmed&&(a.textIcoSalvar='<i class="fa fa-spinner fa-spin" ></i> Salvando',document.getElementById("formAgendaEscala").submit())}))},execluirEscala:function(a){var e=this;Swal.fire({title:"Confirmação",text:"Tem certeza que deseja excluir essa Escala?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#22BAA0",cancelButtonColor:"#d33",cancelButtonText:"Não",confirmButtonText:"Sim"}).then((function(n){n.isConfirmed&&axios.delete("/rpclinica/json/delete-escala/".concat(a)).then((function(a){toastr.success(a.data.message),e.listaEscalas=a.data.escalas})).catch((function(a){return toastr.error(a.response.data.message)}))}))},LetraMaiuscula:function(a){for(var e=a.toLowerCase().split(" "),n=0;n<e.length;n++){var o=e[n];e[n]=o[0].toUpperCase()+o.slice(1)}return e.join(" ")},gerarAgendamentos:function(){var a=this;this.agendaHorarios.escalas.cd_dia?(this.loadingGeracao=!0,axios.post("/rpclinica/json/agenda/horarios/gerar-agendamentos",this.inputsGeracao).then((function(e){toastr.success(e.data.message),a.getHorarios(a.inputsGeracao.cd_agenda,a.inputsGeracao.cd_escala),a.listaEscalas=e.data.escalas})).catch((function(a){return toastr.error(a.response.data.message)})).finally((function(){return a.loadingGeracao=!1}))):toastr.error("Não há dias da semana marcados na genda!")},pesquisaExclusao:function(){var a=this;this.loadingExclusao=!0;var e=new FormData(document.querySelector("#form-exclusao"));e.append("cd_agenda",this.agendaHorarios.agenda.cd_agenda),e.append("cd_escala",this.agendaHorarios.escalas.cd_escala_agenda),axios.post("/rpclinica/json/agenda/horarios/pesquisa-exclusao",e).then((function(e){return a.dadosExclusao=e.data})).catch((function(a){return toastr.error(a.response.data.message)})).finally((function(){return a.loadingExclusao=!1}))},excluirDatas:function(){var a=this;this.loadingExclusaoToggle=!0,axios.post("/rpclinica/json/agenda/horarios/excluir-datas",{cd_agenda:this.inputsGeracao.cd_agenda,cd_escala:this.inputsGeracao.cd_escala,datas:this.datasParaExluir}).then((function(e){toastr.success(e.data.message),a.datasParaExluir.forEach((function(e){delete a.dadosExclusao[e]})),a.datasParaExluir=[]})).catch((function(a){return toastr.error(a.response.data.message)})).finally((function(){return a.loadingExclusaoToggle=!1}))},addEspecialidade:function(){var a,n=this;if(""!=$("#agenda-especialidade").val().trim()&&!this.agendaEspecialidades.find((function(a){return a.cd_especialidade==$("#agenda-especialidade").val()}))){if("undefined"!=typeof agenda)return this.loadingEspecialidade=!0,void axios.post("/rpclinica/json/agenda-especialidade",{cd_agenda:agenda.cd_agenda,cd_especialidade:$("#agenda-especialidade").val()}).then((function(a){var o;n.agendaEspecialidades.push(e(e({},a.data),{},{nm_especialidade:null===(o=especialidades.find((function(a){return a.cd_especialidade==$("#agenda-especialidade").val()})))||void 0===o?void 0:o.nm_especialidade})),$("#agenda-especialidade").val(null).trigger("change")})).finally((function(){return n.loadingEspecialidade=!1}));this.agendaEspecialidades.push({cd_especialidade:$("#agenda-especialidade").val(),nm_especialidade:null===(a=especialidades.find((function(a){return a.cd_especialidade==$("#agenda-especialidade").val()})))||void 0===a?void 0:a.nm_especialidade}),$("#agenda-especialidade").val(null).trigger("change")}},deleteEspecialidade:function(a){var e=this;Swal.fire({title:"Confirmação",text:"Tem certeza que deseja excluir esse cadastro?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Não",confirmButtonText:"Sim"}).then((function(n){if(n.isConfirmed){if("undefined"!=typeof agenda)return e.loadingDelEspecialidade=a,void axios.delete("/rpclinica/json/agenda-especialidade/".concat(e.agendaEspecialidades[a].cd_agenda_espec)).then((function(n){return e.agendaEspecialidades.splice(a,1)})).finally((function(){return e.loadingDelEspecialidade=null}));e.agendaEspecialidades.splice(a,1)}}))},addProcedimento:function(){var a,n=this;if(""!=$("#agenda-procedimento").val().trim()&&!this.agendaProcedimentos.find((function(a){return a.cd_proc==$("#agenda-procedimento").val()}))){if("undefined"!=typeof agenda)return this.loadingProcedimento=!0,void axios.post("/rpclinica/json/agenda-procedimento",{cd_agenda:agenda.cd_agenda,cd_proc:$("#agenda-procedimento").val()}).then((function(a){var o;n.agendaProcedimentos.push(e(e({},a.data),{},{nm_proc:null===(o=procedimentos.find((function(a){return a.cd_proc==$("#agenda-procedimento").val()})))||void 0===o?void 0:o.nm_proc})),$("#agenda-procedimento").val(null).trigger("change")})).finally((function(){return n.loadingProcedimento=!1}));this.agendaProcedimentos.push({cd_proc:$("#agenda-procedimento").val(),nm_proc:null===(a=procedimentos.find((function(a){return a.cd_proc==$("#agenda-procedimento").val()})))||void 0===a?void 0:a.nm_proc}),$("#agenda-procedimento").val(null).trigger("change")}},deleteProcedimento:function(a){var e=this;Swal.fire({title:"Confirmação",text:"Tem certeza que deseja excluir esse cadastro?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Não",confirmButtonText:"Sim"}).then((function(n){if(n.isConfirmed){if("undefined"!=typeof agenda)return e.loadingDelProcedimento=a,void axios.delete("/rpclinica/json/agenda-procedimento/".concat(e.agendaProcedimentos[a].cd_agenda_proc)).then((function(n){return e.agendaProcedimentos.splice(a,1)})).finally((function(){return e.loadingDelProcedimento=null}));e.agendaProcedimentos.splice(a,1)}}))},addProfissional:function(){var a,n=this;if(""!=$("#agenda-profissional").val().trim()&&!this.agendaProfissionais.find((function(a){return a.cd_profissional==$("#agenda-profissional").val()}))){if("undefined"!=typeof agenda)return this.loadingProfissional=!0,void axios.post("/rpclinica/json/agenda-profissional",{cd_agenda:agenda.cd_agenda,cd_profissional:$("#agenda-profissional").val()}).then((function(a){var o;n.agendaProfissionais.push(e(e({},a.data),{},{nm_profissional:null===(o=profissionais.find((function(a){return a.cd_profissional==$("#agenda-profissional").val()})))||void 0===o?void 0:o.nm_profissional})),$("#agenda-profissional").val(null).trigger("change")})).finally((function(){return n.loadingProfissional=!1}));this.agendaProfissionais.push({cd_profissional:$("#agenda-profissional").val(),nm_profissional:null===(a=profissionais.find((function(a){return a.cd_profissional==$("#agenda-profissional").val()})))||void 0===a?void 0:a.nm_profissional}),$("#agenda-profissional").val(null).trigger("change")}},deleteProfissional:function(a){var e=this;Swal.fire({title:"Confirmação",text:"Tem certeza que deseja excluir esse cadastro?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Não",confirmButtonText:"Sim"}).then((function(n){if(n.isConfirmed){if("undefined"!=typeof agenda)return e.loadingDelProfissional=a,void axios.delete("/rpclinica/json/agenda-profissional/".concat(e.agendaProfissionais[a].cd_agenda_prof)).then((function(n){return e.agendaProfissionais.splice(a,1)})).finally((function(){return e.loadingDelProfissional=null}));e.agendaProfissionais.splice(a,1)}}))},addLocal:function(){var a,n=this;if(""!=$("#agenda-local").val().trim()&&!this.agendaLocais.find((function(a){return a.cd_local==$("#agenda-local").val()}))){if("undefined"!=typeof agenda)return this.loadingLocal=!0,void axios.post("/rpclinica/json/agenda-local",{cd_agenda:agenda.cd_agenda,cd_local:$("#agenda-local").val()}).then((function(a){var o;n.agendaLocais.push(e(e({},a.data),{},{nm_local:null===(o=locais.find((function(a){return a.cd_local==$("#agenda-local").val()})))||void 0===o?void 0:o.nm_local})),$("#agenda-local").val(null).trigger("change")})).finally((function(){return n.loadingLocal=!1}));this.agendaLocais.push({cd_local:$("#agenda-local").val(),nm_local:null===(a=locais.find((function(a){return a.cd_local==$("#agenda-local").val()})))||void 0===a?void 0:a.nm_local}),$("#agenda-local").val(null).trigger("change")}},deleteLocal:function(a){var e=this;Swal.fire({title:"Confirmação",text:"Tem certeza que deseja excluir esse cadastro?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Não",confirmButtonText:"Sim"}).then((function(n){if(n.isConfirmed){if("undefined"!=typeof agenda)return e.loadingDelLocal=a,void axios.delete("/rpclinica/json/agenda-local/".concat(e.agendaLocais[a].cd_agenda_local)).then((function(n){return e.agendaLocais.splice(a,1)})).finally((function(){return e.loadingDelLocal=null}));e.agendaLocais.splice(a,1)}}))},addConvenio:function(){var a,n=this;if(""!=$("#agenda-convenio").val().trim()&&!this.agendaConvenios.find((function(a){return a.cd_convenio==$("#agenda-convenio").val()}))){if("undefined"!=typeof agenda)return this.loadingConvenio=!0,void axios.post("/rpclinica/json/agenda-convenio",{cd_agenda:agenda.cd_agenda,cd_convenio:$("#agenda-convenio").val()}).then((function(a){var o;n.agendaConvenios.push(e(e({},a.data),{},{nm_convenio:null===(o=convenios.find((function(a){return a.cd_convenio==$("#agenda-convenio").val()})))||void 0===o?void 0:o.nm_convenio})),$("#agenda-convenio").val(null).trigger("change")})).finally((function(){return n.loadingConvenio=!1}));this.agendaConvenios.push({cd_convenio:$("#agenda-convenio").val(),nm_convenio:null===(a=convenios.find((function(a){return a.cd_convenio==$("#agenda-convenio").val()})))||void 0===a?void 0:a.nm_convenio}),$("#agenda-convenio").val(null).trigger("change")}},deleteConvenio:function(a){var e=this;Swal.fire({title:"Confirmação",text:"Tem certeza que deseja excluir esse cadastro?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#22BAA0",cancelButtonColor:"#d33",cancelButtonText:"Não",confirmButtonText:"Sim"}).then((function(n){if(n.isConfirmed){if("undefined"!=typeof agenda)return e.loadingDelConvenio=a,void axios.delete("/rpclinica/json/agenda-convenio/".concat(e.agendaConvenios[a].cd_agenda_conv)).then((function(n){return e.agendaConvenios.splice(a,1)})).finally((function(){return e.loadingDelConvenio=null}));e.agendaConvenios.splice(a,1)}}))}}})),$(document).ready((function(){$("#agenda-procedimento").select2({ajax:{url:"/rpclinica/json/search-procedimento",dataType:"json",processResults:function(a){var e;null===(e=$("#agenda-procedimento").data("select2").results.lastParams)||void 0===e||e.term;return{results:a}}}})}))})();