Alpine.data("app",(function(){return{loadingGetHorarios:!1,agendaHorarios:null,inputsGeracao:{cd_agenda:null,cd_escala:null,horarios_bloqueados:[],feriados:[]},loadingGeracao:!1,loadingExclusao:!1,dadosExclusao:[],datasParaExluir:[],loadingExclusaoToggle:!1,param:{agenda:null,escala:null},openModalGeracao:function(a,o){this.agendaHorarios=null,this.loadingGetHorarios=!0,this.inputsGeracao.cd_agenda=a,this.inputsGeracao.cd_escala=o,this.inputsGeracao.horarios_bloqueados=[],this.inputsGeracao.feriados=[],this.dadosExclusao=[],this.datasParaExluir=[],this.getHorarios(a,o),$("#cadastro-geracao").modal("toggle")},getHorarios:function(a,o){var s=this;this.param.agenda=a,this.param.escala=o,axios.post("/rpclinica/json/agenda/horarios",this.param).then((function(a){s.agendaHorarios=a.data,console.log(a.data),s.inputsGeracao.feriados=s.agendaHorarios.feriados.map((function(a){return a.dt_feriado})),s.agendaHorarios.escalas.bloqueios_gerados&&(s.inputsGeracao.horarios_bloqueados=s.agendaHorarios.escalas.bloqueios_gerados.lista_horarios.split(",")),s.agendaHorarios.escalas.feriados_gerados&&(s.inputsGeracao.feriados=s.agendaHorarios.escalas.feriados_gerados.lista_datas.split(","))})).catch((function(a){return toastr.error(a.response.data.message)})).finally((function(){return s.loadingGetHorarios=!1}))},timeCut:function(a){return null==a?void 0:a.substr(0,5)},calcIntervalo:function(a){return"".concat(parseInt(a/60).toString().padStart(2,0),":").concat(parseInt(a%60).toString().padStart(2,0))},gerarAgendamentos:function(){var a=this;this.agendaHorarios.escalas.cd_dia?(console.log(this.inputsGeracao),this.loadingGeracao=!0,axios.post("/rpclinica/json/agenda/horarios/gerar-agendamentos",this.inputsGeracao).then((function(o){toastr.success(o.data.message),a.getHorarios(a.inputsGeracao.cd_agenda,a.inputsGeracao.cd_escala)})).catch((function(a){return toastr.error(a.response.data.message)})).finally((function(){return a.loadingGeracao=!1}))):toastr.error("Não há dias da semana marcados na genda!")},pesquisaExclusao:function(){var a=this;this.loadingExclusao=!0,console.log(this.agendaHorarios.agenda.cd_agenda);var o=new FormData(document.querySelector("#form-exclusao"));o.append("cd_agenda",this.agendaHorarios.agenda.cd_agenda),axios.post("/rpclinica/json/agenda/horarios/pesquisa-exclusao",o).then((function(o){return a.dadosExclusao=o.data})).catch((function(a){return toastr.error(a.response.data.message)})).finally((function(){return a.loadingExclusao=!1}))},excluirDatas:function(){var a=this;this.loadingExclusaoToggle=!0,axios.post("/rpclinica/json/agenda/horarios/excluir-datas",{cd_agenda:this.inputsGeracao.cd_agenda,datas:this.datasParaExluir}).then((function(o){toastr.success(o.data.message),a.datasParaExluir.forEach((function(o){delete a.dadosExclusao[o]})),a.datasParaExluir=[]})).catch((function(a){return toastr.error(a.response.data.message)})).finally((function(){return a.loadingExclusaoToggle=!1}))}}})),$(document).ready((function(){$("#cadastro-geracao").modal({backdrop:"static",show:!1})}));